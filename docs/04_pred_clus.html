<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Predator clusters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="04_pred_clus_files/libs/clipboard/clipboard.min.js"></script>
<script src="04_pred_clus_files/libs/quarto-html/quarto.js"></script>
<script src="04_pred_clus_files/libs/quarto-html/popper.min.js"></script>
<script src="04_pred_clus_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="04_pred_clus_files/libs/quarto-html/anchor.min.js"></script>
<link href="04_pred_clus_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="04_pred_clus_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="04_pred_clus_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="04_pred_clus_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="04_pred_clus_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="04_pred_clus_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="04_pred_clus_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="04_pred_clus_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="04_pred_clus_files/libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#predator-clusters" id="toc-predator-clusters" class="nav-link active" data-scroll-target="#predator-clusters">Predator clusters</a></li>
  <li><a href="#optimal-number-of-clusters" id="toc-optimal-number-of-clusters" class="nav-link" data-scroll-target="#optimal-number-of-clusters">Optimal number of clusters</a></li>
  <li><a href="#indicator-species" id="toc-indicator-species" class="nav-link" data-scroll-target="#indicator-species">Indicator species</a>
  <ul class="collapse">
  <li><a href="#cluster-interpretation" id="toc-cluster-interpretation" class="nav-link" data-scroll-target="#cluster-interpretation">Cluster interpretation</a></li>
  </ul></li>
  <li><a href="#cluster-distribution" id="toc-cluster-distribution" class="nav-link" data-scroll-target="#cluster-distribution">Cluster distribution</a></li>
  <li><a href="#nmds" id="toc-nmds" class="nav-link" data-scroll-target="#nmds">NMDS</a>
  <ul class="collapse">
  <li><a href="#nmds-diagnostics" id="toc-nmds-diagnostics" class="nav-link" data-scroll-target="#nmds-diagnostics">NMDS diagnostics</a></li>
  <li><a href="#environmental-loading" id="toc-environmental-loading" class="nav-link" data-scroll-target="#environmental-loading">Environmental loading</a></li>
  </ul></li>
  <li><a href="#environmental-conditions-by-cluster" id="toc-environmental-conditions-by-cluster" class="nav-link" data-scroll-target="#environmental-conditions-by-cluster">Environmental conditions by cluster</a></li>
  <li><a href="#clusters-by-ice-coverage" id="toc-clusters-by-ice-coverage" class="nav-link" data-scroll-target="#clusters-by-ice-coverage">Clusters by ice coverage</a></li>
  <li><a href="#predator-x-prey-clusters" id="toc-predator-x-prey-clusters" class="nav-link" data-scroll-target="#predator-x-prey-clusters">Predator <em>x</em> prey clusters</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predator clusters</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="predator-clusters" class="level2">
<h2 class="anchored" data-anchor-id="predator-clusters">Predator clusters</h2>
<p>Dietrich et al.&nbsp;(2021) restricted cluster analysis to taxa observed at 5% or more of stations, which was necessary to avoid giving rare species too much leverage. Predators are far less diverse, so this analysis retains all species except uncertain IDs (e.g.&nbsp;UNSE = unknown seal). 22 species included in analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>total_stations <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(zoop_sf<span class="sc">$</span>amlr.station)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pred_frac <span class="ot">&lt;-</span> predators_clust <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(amlr.station, species) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count_station =</span> <span class="fu">sum</span>(count),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_count =</span> <span class="fu">sum</span>(count_station),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">stations_present =</span> <span class="fu">n</span>(),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">station_frac =</span> stations_present <span class="sc">/</span> total_stations) <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(station_frac))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>frac_fn <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>pred_frac <span class="sc">%&gt;%</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Ind"</span>, <span class="st">"Stations"</span>, <span class="st">"Fraction"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fraction =</span> <span class="fu">frac_fn</span>(Fraction)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"lrr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">"striped"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Species</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ind</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Stations</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Fraction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SNPT</td>
<td style="text-align: right;">12314</td>
<td style="text-align: right;">233</td>
<td style="text-align: left;">59.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANPT</td>
<td style="text-align: right;">2351</td>
<td style="text-align: right;">209</td>
<td style="text-align: left;">53.0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SGPT</td>
<td style="text-align: right;">620</td>
<td style="text-align: right;">177</td>
<td style="text-align: left;">44.9%</td>
</tr>
<tr class="even">
<td style="text-align: left;">FUSE</td>
<td style="text-align: right;">5443</td>
<td style="text-align: right;">152</td>
<td style="text-align: left;">38.6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KEGU</td>
<td style="text-align: right;">679</td>
<td style="text-align: right;">127</td>
<td style="text-align: left;">32.2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANFU</td>
<td style="text-align: right;">1089</td>
<td style="text-align: right;">108</td>
<td style="text-align: left;">27.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CAPT</td>
<td style="text-align: right;">544</td>
<td style="text-align: right;">84</td>
<td style="text-align: left;">21.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADPN</td>
<td style="text-align: right;">8532</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">17.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CRSE</td>
<td style="text-align: right;">3112</td>
<td style="text-align: right;">58</td>
<td style="text-align: left;">14.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLPT</td>
<td style="text-align: right;">655</td>
<td style="text-align: right;">53</td>
<td style="text-align: left;">13.5%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LESE</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">12.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANTE</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">9.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PFSB</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">6.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">MIWH</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">4.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WESE</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">4.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">GEPN</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">3.0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELSE</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">2.8%</td>
</tr>
<tr class="even">
<td style="text-align: left;">KIWH</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">1.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EMPN</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.5%</td>
</tr>
<tr class="even">
<td style="text-align: left;">SBWH</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.5%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ANSH</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROSE</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.3%</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="optimal-number-of-clusters" class="level2">
<h2 class="anchored" data-anchor-id="optimal-number-of-clusters">Optimal number of clusters</h2>
<p>We use the gap statistic <span class="citation" data-cites="tibshirani2001">(<a href="#ref-tibshirani2001" role="doc-biblioref">Tibshirani, Walther, and Hastie 2001</a>)</span> to choose the optimal number of clusters (<span class="math inline">\(k\)</span>). The gap statistic (<span class="math inline">\(f\)</span>) is a goodness of clustering measure. The authors recommended choosing <span class="math inline">\(k\)</span> at the shoulder of the <span class="math inline">\(f \sim k\)</span> curve. Heuristically, the shoulder is the smallest <span class="math inline">\(k\)</span> such that <span class="math inline">\(f(k) \geq f(k+1) - s(k+1)\)</span> where <span class="math inline">\(s\)</span> is the standard error of <span class="math inline">\(f\)</span>. According to this rule, the predators are best described by three clusters.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ktibs <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tibs_thr <span class="ot">&lt;-</span> <span class="fu">with</span>(sightings_gap, gap[ktibs <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> SE.sim[ktibs <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sightings_gap, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> gap)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> gap <span class="sc">-</span> SE.sim, <span class="at">ymax =</span> gap <span class="sc">+</span> SE.sim)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> gap <span class="sc">-</span> SE.sim, <span class="at">ymax =</span> gap <span class="sc">+</span> SE.sim),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">filter</span>(sightings_gap, k <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> ktibs, <span class="at">xend =</span> ktibs <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> tibs_thr, <span class="at">yend =</span> tibs_thr,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Clusters"</span> <span class="sc">~</span><span class="er">~</span> (<span class="fu">italic</span>(k))),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"Gap statistic"</span> <span class="sc">~</span><span class="er">~</span> (<span class="fu">italic</span>(f)))) <span class="sc">+</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/optimal-clusters-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hierarchical clustering of stations by predator community. Note: 394 stations were included in the zooplankton clustering, but only 245 stations were used for predator clustering.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="fu">names</span>(sightings_cut), sightings_cut)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggtree</span>(sightings_clust, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pred_clust_mrca <span class="ot">&lt;-</span> <span class="fu">sapply</span>(g, <span class="cf">function</span>(n) <span class="fu">MRCA</span>(p, n))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupClade</span>(pred_clust_mrca, <span class="at">group_name =</span> <span class="st">"Predator cluster"</span>) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">Predator cluster</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_dendrogram</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dendrogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/predator_dendro-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="indicator-species" class="level2">
<h2 class="anchored" data-anchor-id="indicator-species">Indicator species</h2>
<p>Which species best represent each cluster? Using Dufrene-Legendre indicator species analysis. Indicator values, <span class="math inline">\(d\)</span>, presented for each cluster for <span class="math inline">\(d\gt0.25\)</span>. <span class="math inline">\(d\)</span> is the product of relative frequency (fraction of sites present within cluster) and relative abundance (fraction of abundance found within cluster).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>indval_mtx <span class="ot">&lt;-</span> sightings_indval<span class="sc">$</span>indval</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>indval_fmt <span class="ot">&lt;-</span> <span class="fu">apply</span>(indval_mtx, <span class="dv">2</span>, <span class="cf">function</span>(x) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  ord <span class="ot">&lt;-</span> <span class="fu">order</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  species <span class="ot">&lt;-</span> <span class="fu">code_to_common</span>(<span class="fu">rownames</span>(indval_mtx))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="fl">0.25</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">str_glue</span>(<span class="st">"{species} ({round(x, 2)})"</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">[</span><span class="st">`</span>(ord) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">"&lt;br&gt;"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(result <span class="sc">==</span> <span class="st">""</span>, <span class="st">"None"</span>, result)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">t</span>(indval_fmt)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adélie penguin (0.37)<br>
Crabeater seal (0.3)</td>
<td style="text-align: left;">Southern fulmar (0.42)<br>
Antarctic petrel (0.41)<br>
Snow petrel (0.34)<br>
Cape petrel (0.28)<br>
Southern giant petrel (0.25)</td>
<td style="text-align: left;">Antarctic fur seal (0.84)<br>
Snow petrel (0.48)<br>
Kelp gull (0.37)<br>
Southern giant petrel (0.36)<br>
Antarctic tern (0.32)<br>
Antarctic petrel (0.29)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<section id="cluster-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="cluster-interpretation">Cluster interpretation</h3>
<ul>
<li>Cluster 1 = pack ice</li>
<li>Cluster 2 = open water</li>
<li>Cluster 3 = marginal ice</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>predators_clust <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(amlr.station, species, count) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(species, amlr.station, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(stations_clust <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(amlr.station, pred_clust),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"amlr.station"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">mutate</span>(., <span class="at">pred_clust =</span> <span class="st">"All clusters"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(station_effort <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">transmute</span>(amlr.station, <span class="at">survey_km =</span> <span class="fu">nmi_to_km</span>(survey_nmi)),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"amlr.station"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, pred_clust) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">density_km =</span> <span class="fu">sum</span>(count) <span class="sc">/</span> <span class="fu">sum</span>(survey_km),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="fu">sum</span>(count <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">density_freq =</span> <span class="fu">str_glue</span>(<span class="st">"{sprintf('%0.3f', density_km)} [{scales::percent(freq, accuracy = 0.1)}]"</span>),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>density_km, <span class="sc">-</span>freq) <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> pred_clust, <span class="at">values_from =</span> density_freq) <span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">All clusters</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: left;">Open water</th>
<th style="text-align: left;">Marginal ice</th>
<th style="text-align: left;">Pack ice</th>
<th style="text-align: left;">All clusters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SNPT</td>
<td style="text-align: left;">1.554 [95.7%]</td>
<td style="text-align: left;">3.116 [96.3%]</td>
<td style="text-align: left;">0.463 [92.5%]</td>
<td style="text-align: left;">1.665 [95.1%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADPN</td>
<td style="text-align: left;">0.004 [6.5%]</td>
<td style="text-align: left;">4.036 [42.6%]</td>
<td style="text-align: left;">0.948 [67.9%]</td>
<td style="text-align: left;">1.153 [27.8%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FUSE</td>
<td style="text-align: left;">0.073 [50.7%]</td>
<td style="text-align: left;">2.892 [100.0%]</td>
<td style="text-align: left;">0.121 [52.8%]</td>
<td style="text-align: left;">0.736 [62.0%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">CRSE</td>
<td style="text-align: left;">0.005 [6.5%]</td>
<td style="text-align: left;">0.437 [38.9%]</td>
<td style="text-align: left;">1.380 [52.8%]</td>
<td style="text-align: left;">0.421 [23.7%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ANPT</td>
<td style="text-align: left;">0.404 [92.8%]</td>
<td style="text-align: left;">0.258 [85.2%]</td>
<td style="text-align: left;">0.177 [66.0%]</td>
<td style="text-align: left;">0.318 [85.3%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANFU</td>
<td style="text-align: left;">0.240 [59.4%]</td>
<td style="text-align: left;">0.033 [29.6%]</td>
<td style="text-align: left;">0.045 [18.9%]</td>
<td style="text-align: left;">0.147 [44.1%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KEGU</td>
<td style="text-align: left;">0.056 [44.2%]</td>
<td style="text-align: left;">0.158 [74.1%]</td>
<td style="text-align: left;">0.108 [49.1%]</td>
<td style="text-align: left;">0.092 [51.8%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLPT</td>
<td style="text-align: left;">0.125 [32.6%]</td>
<td style="text-align: left;">0.090 [13.0%]</td>
<td style="text-align: left;">0.001 [1.9%]</td>
<td style="text-align: left;">0.089 [21.6%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SGPT</td>
<td style="text-align: left;">0.084 [73.2%]</td>
<td style="text-align: left;">0.101 [88.9%]</td>
<td style="text-align: left;">0.066 [52.8%]</td>
<td style="text-align: left;">0.084 [72.2%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">CAPT</td>
<td style="text-align: left;">0.084 [47.8%]</td>
<td style="text-align: left;">0.116 [20.4%]</td>
<td style="text-align: left;">0.006 [13.2%]</td>
<td style="text-align: left;">0.074 [34.3%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LESE</td>
<td style="text-align: left;">0.004 [8.7%]</td>
<td style="text-align: left;">0.080 [38.9%]</td>
<td style="text-align: left;">0.025 [30.2%]</td>
<td style="text-align: left;">0.026 [20.0%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANTE</td>
<td style="text-align: left;">0.012 [9.4%]</td>
<td style="text-align: left;">0.061 [38.9%]</td>
<td style="text-align: left;">0.003 [5.7%]</td>
<td style="text-align: left;">0.021 [15.1%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GEPN</td>
<td style="text-align: left;">0.005 [2.2%]</td>
<td style="text-align: left;">0.054 [5.6%]</td>
<td style="text-align: left;">0.017 [11.3%]</td>
<td style="text-align: left;">0.019 [4.9%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANSH</td>
<td style="text-align: left;">0.022 [0.7%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.012 [0.4%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MIWH</td>
<td style="text-align: left;">0.002 [3.6%]</td>
<td style="text-align: left;">0.018 [13.0%]</td>
<td style="text-align: left;">0.003 [9.4%]</td>
<td style="text-align: left;">0.006 [6.9%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">KIWH</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.023 [5.6%]</td>
<td style="text-align: left;">0.005 [3.8%]</td>
<td style="text-align: left;">0.006 [2.0%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PFSB</td>
<td style="text-align: left;">0.002 [5.8%]</td>
<td style="text-align: left;">0.006 [18.5%]</td>
<td style="text-align: left;">0.006 [13.2%]</td>
<td style="text-align: left;">0.004 [10.2%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">WESE</td>
<td style="text-align: left;">0.002 [5.1%]</td>
<td style="text-align: left;">0.001 [1.9%]</td>
<td style="text-align: left;">0.006 [15.1%]</td>
<td style="text-align: left;">0.003 [6.5%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELSE</td>
<td style="text-align: left;">0.004 [5.8%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.002 [5.7%]</td>
<td style="text-align: left;">0.002 [4.5%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">EMPN</td>
<td style="text-align: left;">0.000 [0.7%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.002 [1.9%]</td>
<td style="text-align: left;">0.001 [0.8%]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SBWH</td>
<td style="text-align: left;">0.001 [1.4%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.001 [0.8%]</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROSE</td>
<td style="text-align: left;">0.000 [0.7%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.000 [0.0%]</td>
<td style="text-align: left;">0.000 [0.4%]</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="cluster-distribution" class="level2">
<h2 class="anchored" data-anchor-id="cluster-distribution">Cluster distribution</h2>
<p>How frequent are the different clusters and where were they found? The open water community was observed most often, followed by the marginal ice zone then the pack ice communities. The relative frequency of the open water community was greatest in 2012, when survey effort in the Bransfield Strait was most limited, and least in 2016. Generally, the open water community occupied the offshore regions, but in 2014 and 2015 it moved onto the shelf into the triangle between Elephant, Joinville, and George Islands.</p>
<p>The marginal ice zone community occupied the shallower, western part of the Bransfield Strait, moving offshore of the Shetland Islands in 2014 and north of Elephant Island in 2016.</p>
<p>The pack ice community was most commonly observed in the south eastern part of the survey region, near Joinville Island. A particularly coherent group of sites in this community formed in 2013 between Joinville Island and the South Shetlands.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stations_clust <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  crosstable<span class="sc">::</span><span class="fu">crosstable</span>(<span class="st">"Year"</span>, <span class="at">by =</span> <span class="st">"pred_clust"</span>, <span class="at">total =</span> <span class="st">"col"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  crosstable<span class="sc">::</span><span class="fu">as_flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-deb6c6d2{}.cl-deb4547e{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-deb45488{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-deb54370{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-deb5437a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-deb54b54{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b55{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b56{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b57{width:1.168in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b5e{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b5f{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b60{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b61{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b68{width:1.168in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b69{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b6a{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b72{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b73{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b74{width:1.168in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b75{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b7c{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b7d{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b7e{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b86{width:1.168in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-deb54b87{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-deb6c6d2"><thead><tr style="overflow-wrap:break-word;"><th rowspan="2" class="cl-deb54b54"><p class="cl-deb54370"><span class="cl-deb4547e">label</span></p></th><th rowspan="2" class="cl-deb54b55"><p class="cl-deb54370"><span class="cl-deb4547e">variable</span></p></th><th colspan="3" class="cl-deb54b56"><p class="cl-deb54370"><span class="cl-deb4547e">pred_clust</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-deb54b61"><p class="cl-deb54370"><span class="cl-deb4547e">Open water</span></p></th><th class="cl-deb54b68"><p class="cl-deb54370"><span class="cl-deb4547e">Marginal ice</span></p></th><th class="cl-deb54b69"><p class="cl-deb54370"><span class="cl-deb4547e">Pack ice</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-deb54b6a"><p class="cl-deb5437a"><span class="cl-deb45488">Year</span></p></td><td class="cl-deb54b72"><p class="cl-deb5437a"><span class="cl-deb45488">2012</span></p></td><td class="cl-deb54b73"><p class="cl-deb5437a"><span class="cl-deb45488">14 (73.68%)</span></p></td><td class="cl-deb54b74"><p class="cl-deb5437a"><span class="cl-deb45488">3 (15.79%)</span></p></td><td class="cl-deb54b75"><p class="cl-deb5437a"><span class="cl-deb45488">2 (10.53%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-deb54b72"><p class="cl-deb5437a"><span class="cl-deb45488">2013</span></p></td><td class="cl-deb54b73"><p class="cl-deb5437a"><span class="cl-deb45488">25 (53.19%)</span></p></td><td class="cl-deb54b74"><p class="cl-deb5437a"><span class="cl-deb45488">11 (23.40%)</span></p></td><td class="cl-deb54b75"><p class="cl-deb5437a"><span class="cl-deb45488">11 (23.40%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-deb54b72"><p class="cl-deb5437a"><span class="cl-deb45488">2014</span></p></td><td class="cl-deb54b73"><p class="cl-deb5437a"><span class="cl-deb45488">39 (57.35%)</span></p></td><td class="cl-deb54b74"><p class="cl-deb5437a"><span class="cl-deb45488">14 (20.59%)</span></p></td><td class="cl-deb54b75"><p class="cl-deb5437a"><span class="cl-deb45488">15 (22.06%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-deb54b72"><p class="cl-deb5437a"><span class="cl-deb45488">2015</span></p></td><td class="cl-deb54b73"><p class="cl-deb5437a"><span class="cl-deb45488">39 (65.00%)</span></p></td><td class="cl-deb54b74"><p class="cl-deb5437a"><span class="cl-deb45488">8 (13.33%)</span></p></td><td class="cl-deb54b75"><p class="cl-deb5437a"><span class="cl-deb45488">13 (21.67%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-deb54b72"><p class="cl-deb5437a"><span class="cl-deb45488">2016</span></p></td><td class="cl-deb54b73"><p class="cl-deb5437a"><span class="cl-deb45488">21 (41.18%)</span></p></td><td class="cl-deb54b74"><p class="cl-deb5437a"><span class="cl-deb45488">18 (35.29%)</span></p></td><td class="cl-deb54b75"><p class="cl-deb5437a"><span class="cl-deb45488">12 (23.53%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-deb54b7d"><p class="cl-deb5437a"><span class="cl-deb45488">Total</span></p></td><td class="cl-deb54b7e"><p class="cl-deb5437a"><span class="cl-deb45488">138 (56.33%)</span></p></td><td class="cl-deb54b86"><p class="cl-deb5437a"><span class="cl-deb45488">54 (22.04%)</span></p></td><td class="cl-deb54b87"><p class="cl-deb5437a"><span class="cl-deb45488">53 (21.63%)</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>map_lim <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(stations_clust) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">project_bbox</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_bbox</span>(<span class="at">factor =</span> <span class="fl">1.2</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sublabels <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Year =</span> <span class="dv">2012</span><span class="sc">:</span><span class="dv">2016</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="sc">-</span><span class="dv">63</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">60</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">crs =</span> <span class="st">"EPSG:4326"</span>, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ant_basemap</span>() <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sea ice</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(x, y, <span class="at">fill =</span> seaice_conc), </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(seaice_conc_df, <span class="fu">between</span>(seaice_conc, <span class="fl">0.65</span>, <span class="dv">1</span>)),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="st">"Ice concentration"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lim =</span> <span class="fu">c</span>(<span class="fl">0.65</span>, <span class="dv">1</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> scales<span class="sc">::</span>percent,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.value =</span> <span class="st">"transparent"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">title.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predator clusters</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale_fill</span>() <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> pred_clust), </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>          stations_clust, </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">2</span>, </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">22</span>) <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Year) <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels), sublabels, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">60</span>, <span class="sc">-</span><span class="dv">55</span>)) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">63</span>, <span class="sc">-</span><span class="dv">62</span>, <span class="sc">-</span><span class="dv">61</span>, <span class="sc">-</span><span class="dv">60</span>)) <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="st">"Predator cluster"</span>, <span class="at">palette =</span> <span class="st">"Dark2"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">title.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_ant</span>(map_lim) <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>())</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs/Figure 4.eps"</span>), p, </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">169</span>, <span class="at">height =</span> <span class="dv">121</span>, <span class="at">units =</span> <span class="st">"mm"</span>)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/cluster_maps-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eks)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cluster_kde <span class="ot">&lt;-</span> stations_clust <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pred_clust) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(\(rows, keys) <span class="fu">st_kde</span>(rows)<span class="sc">$</span>sf <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(contlabel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">95</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pred_clust =</span> keys<span class="sc">$</span>pred_clust)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(sf<span class="sc">:::</span>rbind.sf)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>sublabels <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">pred_clust =</span> <span class="fu">factor</span>(<span class="fu">levels</span>(cluster_kde<span class="sc">$</span>pred_clust)),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="sc">-</span><span class="dv">63</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">60</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">crs =</span> <span class="st">"EPSG:4326"</span>, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ant_basemap</span>() <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predator clusters</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale_fill</span>() <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> pred_clust,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> contlabel), </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>          cluster_kde, </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels), sublabels, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> pred_clust) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">60</span>, <span class="sc">-</span><span class="dv">55</span>)) <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">63</span>, <span class="sc">-</span><span class="dv">62</span>, <span class="sc">-</span><span class="dv">61</span>, <span class="sc">-</span><span class="dv">60</span>)) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="st">"Predator cluster"</span>, <span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_ant</span>(map_lim) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>())</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs/Figure 5.eps"</span>), p, </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">169</span>, <span class="at">height =</span> <span class="dv">57</span>, <span class="at">units =</span> <span class="st">"mm"</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/cluster_maps2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nmds" class="level2">
<h2 class="anchored" data-anchor-id="nmds">NMDS</h2>
<section id="nmds-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="nmds-diagnostics">NMDS diagnostics</h3>
<p>How many NMDS axes should we use? Scree plot indicates 3 axes is acceptable.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nmds_stress, <span class="fu">aes</span>(k, stress)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> nmds_stress<span class="sc">$</span>k) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/nmds-scree-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Shepard diagram demonstrates the ordination distance and observed dissimilarity are acceptably correlated.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nmds_spear <span class="ot">&lt;-</span> <span class="fu">cor</span>(nmds_shepard<span class="sc">$</span>diss,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                  nmds_shepard<span class="sc">$</span>dist,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>nmds_label <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Non-metric fit, R^2 = {round(1 - nmds_sightings$stress^2, 3)}</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Linear fit, R^2 = {round(nmds_spear^2, 3)}</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"k = {nmds_sightings$ndim}</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Stress = {round(nmds_sightings$stress, 3)}"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nmds_shepard, <span class="fu">aes</span>(diss, dist)) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mono), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="fl">2.9</span>, <span class="at">label =</span> nmds_label,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed dissimilarity"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Ordination distance"</span>) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/nmds-shepard-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="environmental-loading" class="level3">
<h3 class="anchored" data-anchor-id="environmental-loading">Environmental loading</h3>
<p>Only two environmental variables were significantly correlated with the NMDS axes: sampling year and ice coverage, with <span class="math inline">\(r^2\)</span> values of 0.061 and 0.053, respectively. Compare this to the macrozooplankton analysis, where 8 environmental values were significantly correlated with the NMDS axes and <span class="math inline">\(r^2\)</span> values were as high as 0.36 (chl <em>a</em> in the upper 100 m) and 0.703 (upper mixed layer salinity).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vector_tbl <span class="ot">&lt;-</span> <span class="fu">with</span>(nmds_envfit<span class="sc">$</span>vectors, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">cbind</span>(arrows, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">r2 =</span> r, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">p =</span> pvals)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"var"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Vector"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(NMDS1<span class="sc">:</span>p, \(x) <span class="fu">sprintf</span>(<span class="st">"%0.3f"</span>, x)))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>factor_tbl <span class="ot">&lt;-</span> <span class="fu">with</span>(nmds_envfit<span class="sc">$</span>factors, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">cbind</span>(centroids, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">r2 =</span> r[var.id],</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">p =</span> pvals[var.id])) <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"var"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Factor"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(NMDS1<span class="sc">:</span>p, \(x) <span class="fu">sprintf</span>(<span class="st">"%0.3f"</span>, x)))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(vector_tbl, factor_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">var</th>
<th style="text-align: left;">NMDS1</th>
<th style="text-align: left;">NMDS2</th>
<th style="text-align: left;">NMDS3</th>
<th style="text-align: left;">r2</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">zuml_m</td>
<td style="text-align: left;">0.245</td>
<td style="text-align: left;">0.958</td>
<td style="text-align: left;">0.149</td>
<td style="text-align: left;">0.003</td>
<td style="text-align: left;">0.917</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">avg.temp</td>
<td style="text-align: left;">0.073</td>
<td style="text-align: left;">0.468</td>
<td style="text-align: left;">0.881</td>
<td style="text-align: left;">0.029</td>
<td style="text-align: left;">0.135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">avg.salinity</td>
<td style="text-align: left;">-0.054</td>
<td style="text-align: left;">0.831</td>
<td style="text-align: left;">-0.554</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;">0.841</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">Integ.chla.100m</td>
<td style="text-align: left;">0.578</td>
<td style="text-align: left;">-0.601</td>
<td style="text-align: left;">0.552</td>
<td style="text-align: left;">0.011</td>
<td style="text-align: left;">0.580</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">Integ.phae.100m</td>
<td style="text-align: left;">-0.526</td>
<td style="text-align: left;">0.848</td>
<td style="text-align: left;">0.069</td>
<td style="text-align: left;">0.011</td>
<td style="text-align: left;">0.564</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">ice_coverage</td>
<td style="text-align: left;">0.325</td>
<td style="text-align: left;">-0.391</td>
<td style="text-align: left;">-0.861</td>
<td style="text-align: left;">0.054</td>
<td style="text-align: left;">0.013</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">TOD_2levels_civilD</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: left;">0.015</td>
<td style="text-align: left;">-0.025</td>
<td style="text-align: left;">0.003</td>
<td style="text-align: left;">0.683</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">TOD_2levels_civilN</td>
<td style="text-align: left;">-0.027</td>
<td style="text-align: left;">-0.050</td>
<td style="text-align: left;">0.048</td>
<td style="text-align: left;">0.003</td>
<td style="text-align: left;">0.683</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">Year2012</td>
<td style="text-align: left;">-0.070</td>
<td style="text-align: left;">-0.093</td>
<td style="text-align: left;">0.260</td>
<td style="text-align: left;">0.061</td>
<td style="text-align: left;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">Year2013</td>
<td style="text-align: left;">-0.062</td>
<td style="text-align: left;">-0.306</td>
<td style="text-align: left;">-0.036</td>
<td style="text-align: left;">0.061</td>
<td style="text-align: left;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">Year2014</td>
<td style="text-align: left;">-0.015</td>
<td style="text-align: left;">-0.007</td>
<td style="text-align: left;">0.061</td>
<td style="text-align: left;">0.061</td>
<td style="text-align: left;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">Year2015</td>
<td style="text-align: left;">-0.011</td>
<td style="text-align: left;">0.258</td>
<td style="text-align: left;">-0.079</td>
<td style="text-align: left;">0.061</td>
<td style="text-align: left;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">Year2016</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.076</td>
<td style="text-align: left;">-0.047</td>
<td style="text-align: left;">0.061</td>
<td style="text-align: left;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">zoop_clust1</td>
<td style="text-align: left;">0.024</td>
<td style="text-align: left;">0.041</td>
<td style="text-align: left;">-0.020</td>
<td style="text-align: left;">0.028</td>
<td style="text-align: left;">0.197</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">zoop_clust2a</td>
<td style="text-align: left;">0.072</td>
<td style="text-align: left;">0.048</td>
<td style="text-align: left;">-0.003</td>
<td style="text-align: left;">0.028</td>
<td style="text-align: left;">0.197</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">zoop_clust2b</td>
<td style="text-align: left;">-0.065</td>
<td style="text-align: left;">-0.101</td>
<td style="text-align: left;">0.117</td>
<td style="text-align: left;">0.028</td>
<td style="text-align: left;">0.197</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">zoop_clust3a</td>
<td style="text-align: left;">-0.133</td>
<td style="text-align: left;">-0.158</td>
<td style="text-align: left;">0.123</td>
<td style="text-align: left;">0.028</td>
<td style="text-align: left;">0.197</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">zoop_clust3b</td>
<td style="text-align: left;">-0.169</td>
<td style="text-align: left;">-0.073</td>
<td style="text-align: left;">-0.309</td>
<td style="text-align: left;">0.028</td>
<td style="text-align: left;">0.197</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">ice_typeOPEN</td>
<td style="text-align: left;">-0.031</td>
<td style="text-align: left;">0.081</td>
<td style="text-align: left;">0.085</td>
<td style="text-align: left;">0.014</td>
<td style="text-align: left;">0.497</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">ice_typeTHIN</td>
<td style="text-align: left;">-0.018</td>
<td style="text-align: left;">-0.002</td>
<td style="text-align: left;">-0.095</td>
<td style="text-align: left;">0.014</td>
<td style="text-align: left;">0.497</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">ice_typeFY</td>
<td style="text-align: left;">0.022</td>
<td style="text-align: left;">-0.043</td>
<td style="text-align: left;">0.040</td>
<td style="text-align: left;">0.014</td>
<td style="text-align: left;">0.497</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">ice_typeMY</td>
<td style="text-align: left;">0.618</td>
<td style="text-align: left;">0.278</td>
<td style="text-align: left;">-0.039</td>
<td style="text-align: left;">0.014</td>
<td style="text-align: left;">0.497</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>NMDS plots, color-coded by predator cluster with year and ice coverage loadings.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>year_centroids <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_envfit, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">display =</span> <span class="st">"factors"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">choices =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"envvar"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_starts</span>(envvar, <span class="st">"Year"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"NMDS"</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> .x <span class="sc">*</span> <span class="fu">ordiArrowMul</span>(nmds_envfit)),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> <span class="fu">substr</span>(envvar, <span class="dv">5</span>, <span class="dv">8</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>nmds_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(axis1, axis2) {</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  ice_ordisurf <span class="ot">&lt;-</span> <span class="fu">ordisurf</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    nmds_sightings <span class="sc">~</span> nmds_env<span class="sc">$</span>ice_coverage,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">c</span>(axis1, axis2),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"NMDS"</span>, axis1)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"NMDS"</span>, axis2)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  ice_df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis1 =</span> ice_ordisurf<span class="sc">$</span>grid<span class="sc">$</span>x,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis2 =</span> ice_ordisurf<span class="sc">$</span>grid<span class="sc">$</span>y,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(<span class="fu">as.numeric</span>(ice_ordisurf<span class="sc">$</span>grid<span class="sc">$</span>z)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(x, y, <span class="st">"ice_coverage"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ice_coverage =</span> ice_coverage <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(ice_coverage)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(nmds_df, <span class="fu">aes</span>(.data[[x]], .data[[y]])) <span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> .data<span class="sc">$</span>ice_coverage, </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">after_stat</span>(level)),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                 ice_df) <span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_distiller</span>(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Ice coverage"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> scales<span class="sc">::</span>percent,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>),</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"in"</span>),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    ggnewscale<span class="sc">::</span><span class="fu">new_scale_color</span>() <span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> pred_clust), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> year_centroids, </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">18</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> Year),</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>                             year_centroids) <span class="sc">+</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">"Dark2"</span>,</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>),</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>                           <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>                           <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Predator cluster"</span>) <span class="sc">+</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">map2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), nmds_plot) <span class="sc">%&gt;%</span> </span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(<span class="st">`</span><span class="at">|</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="st">"pt"</span>),</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs/Figure 6.eps"</span>), p, </span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">169</span>, <span class="at">height =</span> <span class="dv">100</span>, <span class="at">units =</span> <span class="st">"mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_points, x$x, x$y, x$pch, x$size):
semi-transparency is not supported on this device: reported only once per page</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/loading-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="environmental-conditions-by-cluster" class="level2">
<h2 class="anchored" data-anchor-id="environmental-conditions-by-cluster">Environmental conditions by cluster</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>kw <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">c</span>(<span class="st">"zuml_m"</span>, <span class="st">"avg.temp"</span>, <span class="st">"avg.salinity"</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Integ.chla.100m"</span>, <span class="st">"Integ.phae.100m"</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          \(v) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>            kw <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(stations_clust[[v]], stations_clust<span class="sc">$</span>pred_clust)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">var =</span> v, <span class="at">p =</span> kw<span class="sc">$</span>p.value <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>          }) <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>stations_clust <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pred_clust) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(zuml_m, avg.temp, avg.salinity, Integ.chla<span class="fl">.100</span>m, Integ.phae<span class="fl">.100</span>m),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">partial</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">q1 =</span> \(x) <span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">q3 =</span> \(x) <span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">.names =</span> <span class="st">"{.col}={.fn}"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>pred_clust) <span class="sc">%&gt;%</span> </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(name, <span class="st">"="</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"fn"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"fn"</span>, <span class="at">values_from =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(mean<span class="sc">:</span>q3, \(x) <span class="fu">formatC</span>(<span class="fu">signif</span>(x, <span class="at">digits=</span><span class="dv">3</span>), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">format =</span> <span class="st">"fg"</span>, <span class="at">flag =</span> <span class="st">"#"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(pred_clust, var, <span class="at">value =</span> <span class="fu">str_glue</span>(<span class="st">"{mean} ({q1} - {q3})"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> pred_clust, <span class="at">values_from =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(kw, <span class="at">by =</span> <span class="st">"var"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">ifelse</span>(p <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="fu">paste0</span>(var, <span class="st">" *"</span>), var)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>p) <span class="sc">%&gt;%</span> </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">var</th>
<th style="text-align: left;">Open water</th>
<th style="text-align: left;">Marginal ice</th>
<th style="text-align: left;">Pack ice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">zuml_m</td>
<td style="text-align: left;">99.5 (64.8 - 118.)</td>
<td style="text-align: left;">120. (73.0 - 139.)</td>
<td style="text-align: left;">126. (72.0 - 174.)</td>
</tr>
<tr class="even">
<td style="text-align: left;">avg.temp *</td>
<td style="text-align: left;">-1.73 (-1.82 - -1.69)</td>
<td style="text-align: left;">-1.73 (-1.81 - -1.69)</td>
<td style="text-align: left;">-1.80 (-1.84 - -1.76)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">avg.salinity *</td>
<td style="text-align: left;">34.1 (33.9 - 34.2)</td>
<td style="text-align: left;">34.2 (34.1 - 34.3)</td>
<td style="text-align: left;">34.3 (34.1 - 34.4)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Integ.chla.100m *</td>
<td style="text-align: left;">13.4 (8.63 - 16.4)</td>
<td style="text-align: left;">13.0 (7.98 - 16.9)</td>
<td style="text-align: left;">9.39 (5.76 - 13.1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Integ.phae.100m</td>
<td style="text-align: left;">3.73 (2.24 - 4.96)</td>
<td style="text-align: left;">3.30 (1.67 - 4.14)</td>
<td style="text-align: left;">2.96 (1.13 - 3.72)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="clusters-by-ice-coverage" class="level2">
<h2 class="anchored" data-anchor-id="clusters-by-ice-coverage">Clusters by ice coverage</h2>
<p>Median ice coverage increased from the open water cluster (median 34.1%) to the marginal ice (56.0%) and pack ice (74.9%) clusters. This supports the labels of “open water” and “marginal ice” for clusters 3 and 2, respectively. Also provides evidence for the “pack ice” cluster.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>median_coverge <span class="ot">&lt;-</span> stations_clust <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(ice_coverage) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pred_clust) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_ice =</span> <span class="fu">median</span>(ice_coverage <span class="sc">/</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>sublabels <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred_clust =</span> <span class="fu">factor</span>(<span class="fu">levels</span>(stations_clust<span class="sc">$</span>pred_clust)),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">15</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stations_clust, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> ice_coverage <span class="sc">/</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> median_ice),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>             median_coverge,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> labels), sublabels, </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(pred_clust)) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ice coverage"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"# sites"</span>) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs/Figure 3.eps"</span>), p, </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">169</span>, <span class="at">height =</span> <span class="dv">121</span>, <span class="at">units =</span> <span class="st">"mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_pred_clus_files/figure-html/ice_clusters-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predator-x-prey-clusters" class="level2">
<h2 class="anchored" data-anchor-id="predator-x-prey-clusters">Predator <em>x</em> prey clusters</h2>
<p>Predator/prey cluster associations were statistically significant overall (<span class="math inline">\(\chi = 53.6, p&lt;0.001\)</span>) as were 5 pairwise associations after applying Bonferroni correction. The marginal ice and pack ice predator communities were positively associated with macrozooplankton communities 3b (large krill, including <em>E. superba</em>) and 3a (an extremely diverse assemblage associated with cold, high salinity water), respectively. The open water predator community was positively associated with cluster 2b (<em>Thysanoessa macrura</em>) and negatively associated with 3a and 3b. Macrozooplankton cluster 1 (a ubiquitous cluster indicated by <em>Salpa</em> and <em>Clione</em>) was not significantly associated with any predator cluster. Neither was macrozooplankton cluster 2a (indicated by important prey species such as <em>E. frigida</em>, <em>E. triacantha</em>, myctophid larvae, and <em>Themisto gaudichaudii</em>), but it associated most often with the open water predator cluster.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pred_prey_chisq <span class="ot">&lt;-</span> <span class="fu">with</span>(stations_clust, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">chisq.test</span>(pred_clust, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">`</span><span class="at">Winter Cluster factor</span><span class="st">`</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>pred_prey_chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 2000
    replicates)

data:  pred_clust and Winter Cluster factor
X-squared = 59.603, df = NA, p-value = 0.0004998</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pred_prey_chisq<span class="sc">$</span>residuals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Winter Cluster factor
pred_clust               1          2a          2b          3a          3b
  Open water   -0.46769243  1.23921454  2.20564081 -1.40395281 -2.76050332
  Marginal ice  0.01619784 -0.33671751 -0.94850401 -1.68660037  3.61591343
  Pack ice      0.73832851 -1.65974368 -2.60165856  3.96788546  0.80454045</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pred_prey_table <span class="ot">&lt;-</span> <span class="fu">with</span>(stations_clust, <span class="fu">table</span>(pred_clust, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">`</span><span class="at">Winter Cluster factor</span><span class="st">`</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>chisq.posthoc.test<span class="sc">::</span><span class="fu">chisq.posthoc.test</span>(pred_prey_table, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Dimension, Value), </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"zoop_clust"</span>, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">p values</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">p values</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  Dimension    zoop_clust Residuals `p values`
  &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1 Pack ice     3a              4.69   0.000041
2 Open water   3b             -4.36   0.000196
3 Marginal ice 3b              4.27   0.000289
4 Open water   2b              3.65   0.00395 
5 Pack ice     2b             -3.21   0.0197  </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pred_prey_tbl <span class="ot">&lt;-</span> <span class="fu">with</span>(stations_clust, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">table</span>(pred_clust, <span class="st">`</span><span class="at">Winter Cluster factor</span><span class="st">`</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>pred_prey_chisq<span class="sc">$</span>expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Winter Cluster factor
pred_clust            1       2a        2b        3a        3b
  Open water   58.57959 33.79592 22.530612 11.828571 11.265306
  Marginal ice 22.92245 13.22449  8.816327  4.628571  4.408163
  Pack ice     22.49796 12.97959  8.653061  4.542857  4.326531</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pred_prey_chisq<span class="sc">$</span>observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Winter Cluster factor
pred_clust      1 2a 2b 3a 3b
  Open water   55 41 33  7  2
  Marginal ice 23 12  6  1 12
  Pack ice     26  7  1 13  6</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(<span class="st">`</span><span class="at">Predator cluster</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">levels</span>(stations_clust<span class="sc">$</span>pred_clust),</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Zooplankton cluster</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">unique</span>(stations_clust<span class="sc">$</span><span class="st">`</span><span class="at">Winter Cluster factor</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">observed =</span> <span class="fu">map2_int</span>(<span class="st">`</span><span class="at">Predator cluster</span><span class="st">`</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">`</span><span class="at">Zooplankton cluster</span><span class="st">`</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                             \(i, j) pred_prey_chisq<span class="sc">$</span>observed[i, j]),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">expected =</span> <span class="fu">map2_dbl</span>(<span class="st">`</span><span class="at">Predator cluster</span><span class="st">`</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">`</span><span class="at">Zooplankton cluster</span><span class="st">`</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                             \(i, j) pred_prey_chisq<span class="sc">$</span>expected[i, j])) <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">str_glue</span>(<span class="st">"{observed} ({round(expected, 1)})"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">`</span><span class="at">Predator cluster</span><span class="st">`</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> <span class="st">`</span><span class="at">Zooplankton cluster</span><span class="st">`</span>, </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> label) <span class="sc">%&gt;%</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Predator cluster</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2a</th>
<th style="text-align: left;">2b</th>
<th style="text-align: left;">3a</th>
<th style="text-align: left;">3b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Open water</td>
<td style="text-align: left;">55 (58.6)</td>
<td style="text-align: left;">41 (33.8)</td>
<td style="text-align: left;">33 (22.5)</td>
<td style="text-align: left;">7 (11.8)</td>
<td style="text-align: left;">2 (11.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marginal ice</td>
<td style="text-align: left;">23 (22.9)</td>
<td style="text-align: left;">12 (13.2)</td>
<td style="text-align: left;">6 (8.8)</td>
<td style="text-align: left;">1 (4.6)</td>
<td style="text-align: left;">12 (4.4)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pack ice</td>
<td style="text-align: left;">26 (22.5)</td>
<td style="text-align: left;">7 (13)</td>
<td style="text-align: left;">1 (8.7)</td>
<td style="text-align: left;">13 (4.5)</td>
<td style="text-align: left;">6 (4.3)</td>
</tr>
</tbody>
</table>
</div>
</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tibshirani2001" class="csl-entry" role="listitem">
Tibshirani, Robert, Guenther Walther, and Trevor Hastie. 2001. <span>“Estimating the Number of Clusters in a Data Set via the Gap Statistic.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 63 (2): 411–23. <a href="https://doi.org/10.1111/1467-9868.00293">https://doi.org/10.1111/1467-9868.00293</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>